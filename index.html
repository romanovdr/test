{\rtf1\ansi\ansicpg1251\cocoartf2639
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fnil\fcharset0 AppleSymbols;\f2\fnil\fcharset134 PingFangSC-Regular;
\f3\fnil\fcharset0 Menlo-Regular;\f4\fnil\fcharset0 .NewYork-Regular;\f5\fnil\fcharset0 AppleColorEmoji;
}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\paperw11900\paperh16840\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\f0\fs24 \cf0 <!doctype html>\
<html lang="ru">\
<head>\
  <meta charset="utf-8" />\
  <meta name="viewport" content="width=device-width, initial-scale=1" />\
  <title>\uc0\u1050 \u1072 \u1083 \u1100 \u1082 \u1091 \u1083 \u1103 \u1090 \u1086 \u1088  \u1074 \u1099 \u1088 \u1091 \u1095 \u1082 \u1080  \u1089 \u1090 \u1086 \u1084 \u1072 \u1090 \u1086 \u1083 \u1086 \u1075 \u1080 \u1095 \u1077 \u1089 \u1082 \u1086 \u1081  \u1082 \u1083 \u1080 \u1085 \u1080 \u1082 \u1080  \'97 \u1084 \u1086 \u1076 \u1077 \u1083 \u1100  \u1074 \u1086 \u1088 \u1086 \u1085 \u1082 \u1080 </title>\
  <style>\
    :root\{\
      --bg:#07080B;\
      --panel:#0E1016;\
      --panel2:#0B0D12;\
      --card:#10131B;\
      --card2:#0F1219;\
      --stroke:rgba(255,255,255,.08);\
      --stroke2:rgba(255,255,255,.12);\
      --text:rgba(255,255,255,.88);\
      --muted:rgba(255,255,255,.62);\
      --muted2:rgba(255,255,255,.48);\
      --accent:#B84DFF; /* \uc0\u1086 \u1076 \u1080 \u1085  \u1072 \u1082 \u1094 \u1077 \u1085 \u1090  */\
      --danger:#FF4D6D;\
      --ok:#7CFFB2;\
      --shadow: 0 12px 40px rgba(0,0,0,.45);\
      --radius: 18px;\
      --radius2: 14px;\
      --gap: 14px;\
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;\
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";\
    \}\
\
    *\{box-sizing:border-box\}\
    html,body\{height:100%\}\
    body\{\
      margin:0;\
      font-family:var(--sans);\
      background:\
        radial-gradient(1200px 600px at 15% 0%, rgba(184,77,255,.10), transparent 60%),\
        radial-gradient(900px 520px at 90% 20%, rgba(255,77,109,.07), transparent 55%),\
        linear-gradient(180deg, var(--bg), #06070A 60%, #05060A);\
      color:var(--text);\
      line-height:1.35;\
    \}\
\
    a\{color:inherit\}\
    .wrap\{\
      max-width:1160px;\
      margin:0 auto;\
      padding:28px 18px 70px;\
    \}\
\
    header\{\
      display:flex;\
      flex-direction:column;\
      gap:10px;\
      padding:18px 18px 8px;\
    \}\
    .titleRow\{\
      display:flex;\
      gap:14px;\
      align-items:flex-end;\
      flex-wrap:wrap;\
      justify-content:space-between;\
    \}\
    h1\{\
      margin:0;\
      font-size:28px;\
      letter-spacing:-0.02em;\
      font-weight:700;\
    \}\
    .subtitle\{\
      margin:0;\
      color:var(--muted);\
      font-size:14px;\
      max-width:780px;\
    \}\
\
    .topControls\{\
      display:flex;\
      gap:10px;\
      align-items:center;\
      flex-wrap:wrap;\
    \}\
\
    .pillGroup\{\
      display:flex;\
      gap:6px;\
      padding:6px;\
      border:1px solid var(--stroke);\
      background:rgba(255,255,255,.03);\
      border-radius:999px;\
      box-shadow: inset 0 1px 0 rgba(255,255,255,.05);\
    \}\
    .pill\{\
      appearance:none;\
      border:0;\
      background:transparent;\
      color:var(--muted);\
      padding:10px 12px;\
      border-radius:999px;\
      cursor:pointer;\
      font-weight:650;\
      letter-spacing:.01em;\
      transition: .15s ease;\
      font-size:13px;\
      white-space:nowrap;\
    \}\
    .pill[aria-pressed="true"]\{\
      background:linear-gradient(180deg, rgba(184,77,255,.22), rgba(184,77,255,.10));\
      color:var(--text);\
      border:1px solid rgba(184,77,255,.28);\
      box-shadow: 0 6px 20px rgba(184,77,255,.14);\
    \}\
    .pill:hover\{color:var(--text)\}\
\
    .btn\{\
      appearance:none;\
      border:1px solid var(--stroke);\
      background:rgba(255,255,255,.02);\
      color:var(--text);\
      padding:10px 12px;\
      border-radius:999px;\
      cursor:pointer;\
      font-weight:650;\
      font-size:13px;\
      transition:.15s ease;\
      display:inline-flex;\
      align-items:center;\
      gap:8px;\
    \}\
    .btn:hover\{\
      border-color:rgba(255,255,255,.16);\
      background:rgba(255,255,255,.04);\
    \}\
    .btn.primary\{\
      border-color:rgba(184,77,255,.30);\
      background:linear-gradient(180deg, rgba(184,77,255,.22), rgba(184,77,255,.08));\
      box-shadow: 0 10px 28px rgba(184,77,255,.12);\
    \}\
    .btn.primary:hover\{\
      border-color:rgba(184,77,255,.45);\
      background:linear-gradient(180deg, rgba(184,77,255,.28), rgba(184,77,255,.10));\
    \}\
    .btn.danger\{\
      border-color:rgba(255,77,109,.28);\
      background:linear-gradient(180deg, rgba(255,77,109,.18), rgba(255,77,109,.06));\
    \}\
\
    .grid\{\
      display:grid;\
      grid-template-columns: 420px 1fr;\
      gap:18px;\
      margin-top:14px;\
      align-items:start;\
    \}\
\
    .section\{\
      border:1px solid var(--stroke);\
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.015));\
      border-radius:var(--radius);\
      box-shadow: var(--shadow);\
      overflow:hidden;\
    \}\
    .sectionHeader\{\
      padding:16px 16px 12px;\
      border-bottom:1px solid var(--stroke);\
      display:flex;\
      align-items:flex-end;\
      justify-content:space-between;\
      gap:10px;\
      flex-wrap:wrap;\
    \}\
    .sectionHeader h2\{\
      margin:0;\
      font-size:14px;\
      text-transform:uppercase;\
      letter-spacing:.14em;\
      color:rgba(255,255,255,.78);\
      font-weight:800;\
    \}\
    .sectionHeader .hint\{\
      color:var(--muted2);\
      font-size:12px;\
      max-width:520px;\
    \}\
\
    .content\{\
      padding:16px;\
    \}\
\
    .inputs\{\
      display:flex;\
      flex-direction:column;\
      gap:14px;\
    \}\
\
    .blockTitle\{\
      display:flex;\
      align-items:center;\
      justify-content:space-between;\
      gap:10px;\
      margin:14px 0 6px;\
    \}\
    .blockTitle h3\{\
      margin:0;\
      font-size:13px;\
      letter-spacing:.06em;\
      text-transform:uppercase;\
      color:rgba(255,255,255,.80);\
      font-weight:850;\
    \}\
    .blockTitle .micro\{\
      font-size:12px;\
      color:var(--muted2);\
    \}\
\
    .fieldGrid\{\
      display:grid;\
      grid-template-columns: 1fr 160px;\
      gap:10px;\
      align-items:center;\
      padding:10px 12px;\
      background:rgba(255,255,255,.02);\
      border:1px solid var(--stroke);\
      border-radius:var(--radius2);\
    \}\
    .label\{\
      display:flex;\
      flex-direction:column;\
      gap:4px;\
      min-width:0;\
    \}\
    .label .name\{\
      font-size:13px;\
      font-weight:650;\
      color:rgba(255,255,255,.86);\
    \}\
    .label .desc\{\
      font-size:12px;\
      color:var(--muted2);\
    \}\
\
    .inputWrap\{\
      position:relative;\
      display:flex;\
      justify-content:flex-end;\
      align-items:center;\
      gap:8px;\
    \}\
\
    input[type="number"]\{\
      width:160px;\
      max-width:100%;\
      padding:10px 12px;\
      border-radius:12px;\
      border:1px solid rgba(255,255,255,.10);\
      background:rgba(0,0,0,.22);\
      color:rgba(255,255,255,.92);\
      font-family: var(--mono);\
      font-size:14px;\
      outline:none;\
      transition:.15s ease;\
      text-align:right;\
    \}\
    input[type="number"]:focus\{\
      border-color:rgba(184,77,255,.45);\
      box-shadow: 0 0 0 4px rgba(184,77,255,.12);\
    \}\
\
    .suffix\{\
      position:absolute;\
      right:10px;\
      color:rgba(255,255,255,.42);\
      font-size:12px;\
      pointer-events:none;\
      font-family: var(--mono);\
    \}\
    .suffix.pad\{ right:12px; \}\
\
    /* \uc0\u1063 \u1090 \u1086 \u1073 \u1099  \u1089 \u1091 \u1092 \u1092 \u1080 \u1082 \u1089  \u1085 \u1077  \u1079 \u1072 \u1083 \u1077 \u1079 \u1072 \u1083  \u1085 \u1072  \u1094 \u1080 \u1092 \u1088 \u1099  */\
    .withSuffix input\{ padding-right:44px; \}\
    .withSuffix.long input\{ padding-right:58px; \}\
\
    .row\{\
      display:flex;\
      gap:10px;\
      flex-wrap:wrap;\
      align-items:center;\
      justify-content:space-between;\
      margin-bottom:12px;\
    \}\
\
    .toggleLine\{\
      display:flex;\
      align-items:center;\
      gap:10px;\
      flex-wrap:wrap;\
      margin: 8px 0 2px;\
    \}\
\
    .checkbox\{\
      display:flex;\
      align-items:center;\
      gap:10px;\
      padding:10px 12px;\
      border:1px solid var(--stroke);\
      background:rgba(255,255,255,.02);\
      border-radius:999px;\
      user-select:none;\
    \}\
    .checkbox input\{ accent-color: var(--accent); \}\
    .checkbox span\{\
      color:rgba(255,255,255,.82);\
      font-size:13px;\
      font-weight:650;\
    \}\
\
    .presetRow\{\
      display:flex;\
      gap:10px;\
      flex-wrap:wrap;\
      margin:10px 0 2px;\
    \}\
\
    .note\{\
      margin-top:10px;\
      color:var(--muted2);\
      font-size:12px;\
    \}\
\
    /* RESULTS */\
    .resultsGrid\{\
      display:grid;\
      grid-template-columns: repeat(12, 1fr);\
      gap:12px;\
    \}\
    .kpi\{\
      grid-column: span 4;\
      border:1px solid var(--stroke);\
      background:linear-gradient(180deg, rgba(255,255,255,.03), rgba(255,255,255,.01));\
      border-radius:var(--radius2);\
      padding:14px 14px 12px;\
      min-height:92px;\
      display:flex;\
      flex-direction:column;\
      justify-content:space-between;\
    \}\
    .kpi .k\{\
      display:flex;\
      align-items:center;\
      justify-content:space-between;\
      gap:10px;\
    \}\
    .kpi .name\{\
      font-size:12px;\
      color:var(--muted2);\
      letter-spacing:.06em;\
      text-transform:uppercase;\
      font-weight:850;\
    \}\
    .kpi .badge\{\
      font-size:12px;\
      color:rgba(255,255,255,.70);\
      border:1px solid var(--stroke);\
      background:rgba(0,0,0,.18);\
      padding:6px 10px;\
      border-radius:999px;\
      font-family: var(--mono);\
      white-space:nowrap;\
    \}\
    .kpi .v\{\
      font-size:26px;\
      letter-spacing:-0.03em;\
      font-weight:900;\
      font-family: var(--mono);\
    \}\
    .kpi .v.accent\{ color:rgba(255,255,255,.94); \}\
    .kpi .v.money\{ color: rgba(255,255,255,.94); \}\
    .kpi .v.strong\{\
      background: linear-gradient(90deg, rgba(184,77,255,.96), rgba(255,77,109,.92));\
      -webkit-background-clip: text;\
      background-clip: text;\
      color: transparent;\
    \}\
    .kpi .sub\{\
      margin-top:6px;\
      font-size:12px;\
      color:var(--muted2);\
      display:flex;\
      align-items:center;\
      justify-content:space-between;\
      gap:10px;\
      font-family: var(--mono);\
    \}\
\
    .kpi.wide\{ grid-column: span 6; \}\
\
    .divider\{\
      height:1px;\
      background:var(--stroke);\
      margin:14px 0;\
    \}\
\
    /* Funnel */\
    .funnel\{\
      display:flex;\
      flex-direction:column;\
      gap:10px;\
    \}\
    .fRow\{\
      border:1px solid var(--stroke);\
      border-radius:16px;\
      padding:12px 12px;\
      background:rgba(255,255,255,.02);\
      display:grid;\
      grid-template-columns: 210px 1fr;\
      gap:12px;\
      align-items:center;\
      position:relative;\
      overflow:hidden;\
    \}\
    .fRow::before\{\
      content:"";\
      position:absolute;\
      inset:0;\
      background:linear-gradient(90deg, rgba(184,77,255,.10), transparent 40%);\
      opacity:.0;\
      transition:.15s ease;\
      pointer-events:none;\
    \}\
    .fRow.bottleneck\{\
      border-color: rgba(255,77,109,.35);\
      box-shadow: 0 10px 30px rgba(255,77,109,.12);\
    \}\
    .fRow.bottleneck::before\{ opacity:.10; \}\
\
    .fLeft\{\
      display:flex;\
      flex-direction:column;\
      gap:6px;\
      min-width:0;\
    \}\
    .fLeft .stage\{\
      font-weight:850;\
      font-size:13px;\
      letter-spacing:.02em;\
      display:flex;\
      align-items:center;\
      gap:8px;\
    \}\
    .dot\{\
      width:10px; height:10px; border-radius:50%;\
      background:rgba(255,255,255,.20);\
      border:1px solid rgba(255,255,255,.18);\
      box-shadow: inset 0 1px 0 rgba(255,255,255,.06);\
    \}\
    .bottleneck .dot\{\
      background:rgba(255,77,109,.85);\
      border-color: rgba(255,77,109,.55);\
      box-shadow: inset 0 1px 0 rgba(255,255,255,.06), 0 10px 22px rgba(255,77,109,.20);\
    \}\
    .fLeft .meta\{\
      color:var(--muted2);\
      font-size:12px;\
      display:flex;\
      gap:10px;\
      flex-wrap:wrap;\
      font-family:var(--mono);\
    \}\
\
    .barWrap\{\
      display:flex;\
      flex-direction:column;\
      gap:6px;\
    \}\
    .bar\{\
      height:14px;\
      border-radius:999px;\
      background:rgba(255,255,255,.06);\
      border:1px solid rgba(255,255,255,.08);\
      overflow:hidden;\
    \}\
    .fill\{\
      height:100%;\
      width:0%;\
      border-radius:999px;\
      background:linear-gradient(90deg, rgba(184,77,255,.95), rgba(255,77,109,.90));\
      box-shadow: 0 8px 20px rgba(184,77,255,.16);\
    \}\
    .bottleneck .fill\{\
      filter:saturate(1.1);\
      box-shadow: 0 12px 26px rgba(255,77,109,.14);\
    \}\
    .barHint\{\
      display:flex;\
      justify-content:space-between;\
      gap:10px;\
      color:var(--muted2);\
      font-size:12px;\
      font-family:var(--mono);\
    \}\
\
    /* Recommendations */\
    .reco\{\
      display:flex;\
      flex-direction:column;\
      gap:10px;\
    \}\
    .chip\{\
      border:1px solid var(--stroke);\
      background:rgba(255,255,255,.02);\
      padding:12px 12px;\
      border-radius:16px;\
      display:flex;\
      gap:10px;\
      align-items:flex-start;\
    \}\
    .chip .icon\{\
      width:26px; height:26px;\
      border-radius:10px;\
      display:flex;\
      align-items:center;\
      justify-content:center;\
      font-size:14px;\
      border:1px solid rgba(255,255,255,.10);\
      background:rgba(0,0,0,.18);\
      flex: 0 0 auto;\
      margin-top:2px;\
    \}\
    .chip .txt\{\
      display:flex;\
      flex-direction:column;\
      gap:4px;\
      min-width:0;\
    \}\
    .chip .t\{\
      font-weight:800;\
      font-size:13px;\
      color:rgba(255,255,255,.88);\
    \}\
    .chip .d\{\
      color:var(--muted2);\
      font-size:12px;\
    \}\
    .chip.bad .icon\{\
      border-color: rgba(255,77,109,.30);\
      background: rgba(255,77,109,.10);\
    \}\
    .chip.good .icon\{\
      border-color: rgba(124,255,178,.25);\
      background: rgba(124,255,178,.08);\
    \}\
\
    .toast\{\
      position:fixed;\
      left:50%;\
      transform:translateX(-50%);\
      bottom:16px;\
      background:rgba(15,18,25,.92);\
      border:1px solid rgba(255,255,255,.10);\
      padding:10px 12px;\
      border-radius:999px;\
      box-shadow: var(--shadow);\
      font-size:13px;\
      color:rgba(255,255,255,.86);\
      display:none;\
      align-items:center;\
      gap:8px;\
      z-index:99;\
      backdrop-filter: blur(10px);\
    \}\
    .toast.show\{ display:flex; \}\
\
    /* Responsive */\
    @media (max-width: 1040px)\{\
      .grid\{ grid-template-columns: 1fr; \}\
      .resultsGrid\{ grid-template-columns: repeat(6,1fr); \}\
      .kpi\{ grid-column: span 3; \}\
      .kpi.wide\{ grid-column: span 6; \}\
    \}\
    @media (max-width: 640px)\{\
      header\{ padding:16px 10px 6px; \}\
      h1\{ font-size:22px; \}\
      .subtitle\{ font-size:13px; \}\
      .wrap\{ padding:18px 12px 60px; \}\
      .content\{ padding:12px; \}\
      .sectionHeader\{ padding:14px 12px 10px; \}\
      .fieldGrid\{ grid-template-columns: 1fr; \}\
      input[type="number"]\{ width:100%; \}\
      .resultsGrid\{ grid-template-columns: repeat(2,1fr); \}\
      .kpi\{ grid-column: span 2; \}\
      .kpi.wide\{ grid-column: span 2; \}\
      .fRow\{ grid-template-columns: 1fr; \}\
    \}\
  </style>\
</head>\
<body>\
  <div class="wrap">\
    <header>\
      <div class="titleRow">\
        <div>\
          <h1>\uc0\u1050 \u1072 \u1083 \u1100 \u1082 \u1091 \u1083 \u1103 \u1090 \u1086 \u1088  \u1074 \u1099 \u1088 \u1091 \u1095 \u1082 \u1080  \u1089 \u1090 \u1086 \u1084 \u1072 \u1090 \u1086 \u1083 \u1086 \u1075 \u1080 \u1095 \u1077 \u1089 \u1082 \u1086 \u1081  \u1082 \u1083 \u1080 \u1085 \u1080 \u1082 \u1080 : \u1084 \u1086 \u1076 \u1077 \u1083 \u1100  \u1074 \u1086 \u1088 \u1086 \u1085 \u1082 \u1080  \u1087 \u1088 \u1086 \u1076 \u1072 \u1078 </h1>\
          <p class="subtitle">\uc0\u1057 \u1084 \u1086 \u1076 \u1077 \u1083 \u1080 \u1088 \u1091 \u1081  \u1074 \u1086 \u1088 \u1086 \u1085 \u1082 \u1091  \u1080  \u1087 \u1086 \u1081 \u1084 \u1080 , \u1089 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1076 \u1077 \u1085 \u1077 \u1075  \u1090 \u1099  \u1088 \u1077 \u1072 \u1083 \u1100 \u1085 \u1086  \u1087 \u1077 \u1095 \u1072 \u1090 \u1072 \u1077 \u1096 \u1100  (\u1080 \u1083 \u1080  \u1090 \u1077 \u1088 \u1103 \u1077 \u1096 \u1100 ).</p>\
        </div>\
        <div class="topControls">\
          <div class="pillGroup" role="group" aria-label="\uc0\u1057 \u1094 \u1077 \u1085 \u1072 \u1088 \u1080 \u1081 ">\
            <button class="pill" id="btnScenarioP" aria-pressed="true" title="\uc0\u1055 \u1077 \u1089 \u1089 \u1080 \u1084 \u1080 \u1089 \u1090 \u1080 \u1095 \u1085 \u1099 \u1081 ">\u1055 \u1045 \u1057 \u1057 \u1048 \u1052 \u1048 \u1057 \u1058 \u1048 \u1063 \u1053 \u1067 \u1049 </button>\
            <button class="pill" id="btnScenarioI" aria-pressed="false" title="\uc0\u1048 \u1076 \u1077 \u1072 \u1083 \u1100 \u1085 \u1099 \u1081 ">\u1048 \u1044 \u1045 \u1040 \u1051 \u1068 \u1053 \u1067 \u1049 </button>\
          </div>\
          <button class="btn" id="btnCopyLink">
\f1 \uc0\u10697 
\f0  \uc0\u1057 \u1082 \u1086 \u1087 \u1080 \u1088 \u1086 \u1074 \u1072 \u1090 \u1100  \u1089 \u1089 \u1099 \u1083 \u1082 \u1091 </button>\
          <button class="btn" id="btnCSV">
\f2 \uc0\u8681 
\f0  \uc0\u1057 \u1082 \u1072 \u1095 \u1072 \u1090 \u1100  CSV</button>\
          <button class="btn danger" id="btnReset">
\f3 \uc0\u8634 
\f0  \uc0\u1057 \u1073 \u1088 \u1086 \u1089 </button>\
        </div>\
      </div>\
\
      <div class="presetRow">\
        <button class="btn primary" id="presetImplant">
\f3 \uc0\u9881 \u65038 
\f0  \uc0\u1055 \u1088 \u1077 \u1089 \u1077 \u1090 : \u1048 \u1084 \u1087 \u1083 \u1072 \u1085 \u1090 \u1072 \u1094 \u1080 \u1103  (\u1074 \u1099 \u1089 \u1086 \u1082 \u1080 \u1081  \u1095 \u1077 \u1082 )</button>\
        <button class="btn primary" id="presetTherapy">
\f3 \uc0\u9881 \u65038 
\f0  \uc0\u1055 \u1088 \u1077 \u1089 \u1077 \u1090 : \u1058 \u1077 \u1088 \u1072 \u1087 \u1080 \u1103  (\u1089 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1095 \u1077 \u1082 )</button>\
        <span class="note" style="margin:0;align-self:center;">\uc0\u1055 \u1088 \u1077 \u1089 \u1077 \u1090 \u1099  \u1087 \u1088 \u1080 \u1084 \u1077 \u1085 \u1103 \u1102 \u1090 \u1089 \u1103  \u1082  \u1072 \u1082 \u1090 \u1080 \u1074 \u1085 \u1086 \u1084 \u1091  \u1089 \u1094 \u1077 \u1085 \u1072 \u1088 \u1080 \u1102 .</span>\
      </div>\
    </header>\
\
    <div class="grid">\
      <section class="section" aria-label="\uc0\u1042 \u1093 \u1086 \u1076 \u1085 \u1099 \u1077  \u1076 \u1072 \u1085 \u1085 \u1099 \u1077 ">\
        <div class="sectionHeader">\
          <div>\
            <h2>\uc0\u1042 \u1093 \u1086 \u1076 \u1085 \u1099 \u1077  \u1076 \u1072 \u1085 \u1085 \u1099 \u1077 </h2>\
            <div class="hint">\uc0\u1047 \u1072 \u1087 \u1086 \u1083 \u1085 \u1080  \u1094 \u1080 \u1092 \u1088 \u1099  \'97 \u1080  \u1089 \u1088 \u1072 \u1079 \u1091  \u1091 \u1074 \u1080 \u1076 \u1080 \u1096 \u1100  \u1074 \u1099 \u1088 \u1091 \u1095 \u1082 \u1091 , \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 , ROMI \u1080  \u1075 \u1076 \u1077  \u1074 \u1086 \u1088 \u1086 \u1085 \u1082 \u1072  \u1090 \u1077 \u1095 \u1105 \u1090 .</div>\
          </div>\
          <div class="pillGroup" role="group" aria-label="\uc0\u1056 \u1077 \u1078 \u1080 \u1084  \u1082 \u1083 \u1080 \u1082 \u1086 \u1074 ">\
            <button class="pill" id="modeCPC" aria-pressed="true">\uc0\u1041 \u1070 \u1044 \u1046 \u1045 \u1058  + CPC</button>\
            <button class="pill" id="modeClicks" aria-pressed="false">\uc0\u1050 \u1051 \u1048 \u1050 \u1048  \u1042  \u1052 \u1045 \u1057 \u1071 \u1062 </button>\
          </div>\
        </div>\
\
        <div class="content">\
          <div class="inputs">\
            <div>\
              <div class="blockTitle">\
                <h3>A. \uc0\u1058 \u1088 \u1072 \u1092 \u1080 \u1082  \u1080  \u1079 \u1072 \u1103 \u1074 \u1082 \u1080 </h3>\
                <div class="micro">\uc0\u1057 \u1074 \u1077 \u1088 \u1093 \u1091  \u1074 \u1086 \u1088 \u1086 \u1085 \u1082 \u1080  \'97 \u1090 \u1091 \u1090  \u1095 \u1072 \u1089 \u1090 \u1086  \'ab\u1084 \u1072 \u1075 \u1080 \u1103  \u1084 \u1072 \u1088 \u1082 \u1077 \u1090 \u1086 \u1083 \u1086 \u1075 \u1072 \'bb \u1080  \u1088 \u1077 \u1072 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1100  \u1088 \u1072 \u1089 \u1093 \u1086 \u1076 \u1103 \u1090 \u1089 \u1103 .</div>\
              </div>\
\
              <div class="fieldGrid">\
                <div class="label">\
                  <div class="name">\uc0\u1056 \u1077 \u1082 \u1083 \u1072 \u1084 \u1085 \u1099 \u1081  \u1073 \u1102 \u1076 \u1078 \u1077 \u1090  \u1074  \u1084 \u1077 \u1089 \u1103 \u1094 </div>\
                  <div class="desc">\uc0\u1057 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1088 \u1077 \u1072 \u1083 \u1100 \u1085 \u1086  \u1090 \u1088 \u1072 \u1090 \u1080 \u1084  \u1085 \u1072  \u1088 \u1077 \u1082 \u1083 \u1072 \u1084 \u1091 .</div>\
                </div>\
                <div class="inputWrap withSuffix long">\
                  <input id="budget" type="number" min="0" step="1000" />\
                  <span class="suffix">
\f4 \uc0\u8381 
\f0 </span>\
                </div>\
              </div>\
\
              <div class="fieldGrid" id="rowCPC">\
                <div class="label">\
                  <div class="name">\uc0\u1062 \u1077 \u1085 \u1072  \u1082 \u1083 \u1080 \u1082 \u1072  (CPC)</div>\
                  <div class="desc">\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1103 \u1103  \u1094 \u1077 \u1085 \u1072  \u1082 \u1083 \u1080 \u1082 \u1072  \u1074  \u1088 \u1077 \u1082 \u1083 \u1072 \u1084 \u1077 .</div>\
                </div>\
                <div class="inputWrap withSuffix long">\
                  <input id="cpc" type="number" min="0" step="1" />\
                  <span class="suffix">
\f4 \uc0\u8381 
\f0 </span>\
                </div>\
              </div>\
\
              <div class="fieldGrid" id="rowClicks" style="display:none;">\
                <div class="label">\
                  <div class="name">\uc0\u1050 \u1083 \u1080 \u1082 \u1080  \u1074  \u1084 \u1077 \u1089 \u1103 \u1094 </div>\
                  <div class="desc">\uc0\u1045 \u1089 \u1083 \u1080  \u1082 \u1083 \u1080 \u1082 \u1080  \u1091 \u1078 \u1077  \u1080 \u1079 \u1074 \u1077 \u1089 \u1090 \u1085 \u1099  \'97 \u1074 \u1074 \u1077 \u1076 \u1080  \u1085 \u1072 \u1087 \u1088 \u1103 \u1084 \u1091 \u1102 .</div>\
                </div>\
                <div class="inputWrap withSuffix">\
                  <input id="clicksManual" type="number" min="0" step="1" />\
                  <span class="suffix">\uc0\u1096 \u1090 </span>\
                </div>\
              </div>\
\
              <div class="fieldGrid">\
                <div class="label">\
                  <div class="name">\uc0\u1050 \u1086 \u1085 \u1074 \u1077 \u1088 \u1089 \u1080 \u1103  \u1089 \u1072 \u1081 \u1090 \u1072  \u1074  \u1079 \u1072 \u1103 \u1074 \u1082 \u1091 </div>\
                  <div class="desc">CR: \uc0\u1080 \u1079  \u1082 \u1083 \u1080 \u1082 \u1086 \u1074  \u1074  \u1079 \u1072 \u1103 \u1074 \u1082 \u1080 .</div>\
                </div>\
                <div class="inputWrap withSuffix">\
                  <input id="crSite" type="number" min="0" max="100" step="0.1" />\
                  <span class="suffix">%</span>\
                </div>\
              </div>\
\
              <div class="fieldGrid">\
                <div class="label">\
                  <div class="name">\uc0\u1044 \u1086 \u1083 \u1103  \u1094 \u1077 \u1083 \u1077 \u1074 \u1099 \u1093  \u1079 \u1072 \u1103 \u1074 \u1086 \u1082 </div>\
                  <div class="desc">\uc0\u1057 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1079 \u1072 \u1103 \u1074 \u1086 \u1082  \u1088 \u1077 \u1072 \u1083 \u1100 \u1085 \u1086  \u1087 \u1088 \u1086  \u1074 \u1072 \u1096 \u1080  \u1091 \u1089 \u1083 \u1091 \u1075 \u1080 /\u1076 \u1077 \u1085 \u1100 \u1075 \u1080 .</div>\
                </div>\
                <div class="inputWrap withSuffix">\
                  <input id="shareTarget" type="number" min="0" max="100" step="0.1" />\
                  <span class="suffix">%</span>\
                </div>\
              </div>\
            </div>\
\
            <div>\
              <div class="blockTitle">\
                <h3>B. \uc0\u1050 \u1086 \u1083 \u1083 -\u1094 \u1077 \u1085 \u1090 \u1088  / \u1072 \u1076 \u1084 \u1080 \u1085 \u1099 </h3>\
                <div class="micro">\uc0\u1069 \u1090 \u1086  \u1084 \u1077 \u1089 \u1090 \u1086 , \u1075 \u1076 \u1077  \u1095 \u1072 \u1097 \u1077  \u1074 \u1089 \u1077 \u1075 \u1086  \'ab\u1074 \u1089 \u1105  \u1083 \u1086 \u1084 \u1072 \u1077 \u1090 \u1089 \u1103  \u1090 \u1080 \u1093 \u1086 \'bb.</div>\
              </div>\
\
              <div class="fieldGrid">\
                <div class="label">\
                  <div class="name">\uc0\u1044 \u1086 \u1079 \u1074 \u1086 \u1085 </div>\
                  <div class="desc">\uc0\u1044 \u1086 \u1083 \u1103  \u1094 \u1077 \u1083 \u1077 \u1074 \u1099 \u1093  \u1079 \u1072 \u1103 \u1074 \u1086 \u1082 , \u1076 \u1086  \u1082 \u1086 \u1090 \u1086 \u1088 \u1099 \u1093  \u1076 \u1086 \u1079 \u1074 \u1086 \u1085 \u1080 \u1083 \u1080 \u1089 \u1100 .</div>\
                </div>\
                <div class="inputWrap withSuffix">\
                  <input id="callRate" type="number" min="0" max="100" step="0.1" />\
                  <span class="suffix">%</span>\
                </div>\
              </div>\
\
              <div class="fieldGrid">\
                <div class="label">\
                  <div class="name">\uc0\u1047 \u1072 \u1087 \u1080 \u1089 \u1100  \u1085 \u1072  \u1082 \u1086 \u1085 \u1089 \u1091 \u1083 \u1100 \u1090 \u1072 \u1094 \u1080 \u1102 </div>\
                  <div class="desc">\uc0\u1048 \u1079  \u1076 \u1086 \u1079 \u1074 \u1086 \u1085 \u1072  \'97 \u1089 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1079 \u1072 \u1087 \u1080 \u1089 \u1072 \u1083 \u1080 .</div>\
                </div>\
                <div class="inputWrap withSuffix">\
                  <input id="bookRate" type="number" min="0" max="100" step="0.1" />\
                  <span class="suffix">%</span>\
                </div>\
              </div>\
\
              <div class="fieldGrid">\
                <div class="label">\
                  <div class="name">\uc0\u1044 \u1086 \u1096 \u1083 \u1080  \u1085 \u1072  \u1082 \u1086 \u1085 \u1089 \u1091 \u1083 \u1100 \u1090 \u1072 \u1094 \u1080 \u1102 </div>\
                  <div class="desc">\uc0\u1048 \u1079  \u1079 \u1072 \u1087 \u1080 \u1089 \u1072 \u1085 \u1085 \u1099 \u1093  \'97 \u1089 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1088 \u1077 \u1072 \u1083 \u1100 \u1085 \u1086  \u1087 \u1088 \u1080 \u1096 \u1083 \u1086 .</div>\
                </div>\
                <div class="inputWrap withSuffix">\
                  <input id="showRate" type="number" min="0" max="100" step="0.1" />\
                  <span class="suffix">%</span>\
                </div>\
              </div>\
            </div>\
\
            <div>\
              <div class="blockTitle">\
                <h3>C. \uc0\u1042 \u1088 \u1072 \u1095 \u1080  / \u1087 \u1088 \u1086 \u1076 \u1072 \u1078 \u1080 </h3>\
                <div class="micro">\uc0\u1058 \u1091 \u1090  \u1074 \u1099 \u1080 \u1075 \u1088 \u1099 \u1074 \u1072 \u1077 \u1090  \u1085 \u1077  \'ab\u1093 \u1072 \u1088 \u1080 \u1079 \u1084 \u1072 \'bb, \u1072  \u1085 \u1086 \u1088 \u1084 \u1072 \u1083 \u1100 \u1085 \u1072 \u1103  \u1076 \u1080 \u1072 \u1075 \u1085 \u1086 \u1089 \u1090 \u1080 \u1082 \u1072  \u1080  \u1087 \u1086 \u1085 \u1103 \u1090 \u1085 \u1099 \u1081  \u1087 \u1083 \u1072 \u1085 .</div>\
              </div>\
\
              <div class="fieldGrid">\
                <div class="label">\
                  <div class="name">\uc0\u1050 \u1086 \u1085 \u1074 \u1077 \u1088 \u1089 \u1080 \u1103  \u1082 \u1086 \u1085 \u1089 \u1091 \u1083 \u1100 \u1090 \u1072 \u1094 \u1080 \u1080  \u1074  \u1087 \u1083 \u1072 \u1085  \u1083 \u1077 \u1095 \u1077 \u1085 \u1080 \u1103 </div>\
                  <div class="desc">\uc0\u1048 \u1079  \u1087 \u1088 \u1080 \u1096 \u1077 \u1076 \u1096 \u1080 \u1093  \'97 \u1091  \u1089 \u1082 \u1086 \u1083 \u1100 \u1082 \u1080 \u1093  \u1077 \u1089 \u1090 \u1100  \u1087 \u1083 \u1072 \u1085 .</div>\
                </div>\
                <div class="inputWrap withSuffix">\
                  <input id="planRate" type="number" min="0" max="100" step="0.1" />\
                  <span class="suffix">%</span>\
                </div>\
              </div>\
\
              <div class="fieldGrid">\
                <div class="label">\
                  <div class="name">\uc0\u1050 \u1086 \u1085 \u1074 \u1077 \u1088 \u1089 \u1080 \u1103  \u1087 \u1083 \u1072 \u1085 \u1072  \u1083 \u1077 \u1095 \u1077 \u1085 \u1080 \u1103  \u1074  \u1086 \u1087 \u1083 \u1072 \u1090 \u1091 </div>\
                  <div class="desc">\uc0\u1048 \u1079  \u1087 \u1083 \u1072 \u1085 \u1086 \u1074  \'97 \u1089 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1086 \u1087 \u1083 \u1072 \u1090 \u1080 \u1083 \u1080  (\u1087 \u1072 \u1094 \u1080 \u1077 \u1085 \u1090 \u1099 ).</div>\
                </div>\
                <div class="inputWrap withSuffix">\
                  <input id="payRate" type="number" min="0" max="100" step="0.1" />\
                  <span class="suffix">%</span>\
                </div>\
              </div>\
\
              <div class="fieldGrid">\
                <div class="label">\
                  <div class="name">\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1095 \u1077 \u1082 </div>\
                  <div class="desc">\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1103 \u1103  \u1089 \u1091 \u1084 \u1084 \u1072  \u1087 \u1086  \u1087 \u1077 \u1088 \u1074 \u1086 \u1084 \u1091  \u1083 \u1077 \u1095 \u1077 \u1085 \u1080 \u1102 /\u1082 \u1091 \u1088 \u1089 \u1091 .</div>\
                </div>\
                <div class="inputWrap withSuffix long">\
                  <input id="avgCheck" type="number" min="0" step="1000" />\
                  <span class="suffix">
\f4 \uc0\u8381 
\f0 </span>\
                </div>\
              </div>\
\
              <div class="fieldGrid">\
                <div class="label">\
                  <div class="name">\uc0\u1052 \u1072 \u1088 \u1078 \u1080 \u1085 \u1072 \u1083 \u1100 \u1085 \u1086 \u1089 \u1090 \u1100 </div>\
                  <div class="desc">\uc0\u1042 \u1072 \u1083 \u1086 \u1074 \u1072 \u1103  \u1084 \u1072 \u1088 \u1078 \u1072  (\u1087 \u1086 \u1089 \u1083 \u1077  \u1089 \u1077 \u1073 \u1077 \u1089 \u1090 \u1086 \u1080 \u1084 \u1086 \u1089 \u1090 \u1080 ).</div>\
                </div>\
                <div class="inputWrap withSuffix">\
                  <input id="margin" type="number" min="0" max="100" step="0.1" />\
                  <span class="suffix">%</span>\
                </div>\
              </div>\
            </div>\
\
            <div>\
              <div class="blockTitle">\
                <h3>D. \uc0\u1055 \u1086 \u1074 \u1090 \u1086 \u1088 \u1085 \u1099 \u1077  \u1087 \u1088 \u1086 \u1076 \u1072 \u1078 \u1080 </h3>\
                <div class="micro">\uc0\u1054 \u1087 \u1094 \u1080 \u1086 \u1085 \u1072 \u1083 \u1100 \u1085 \u1086 : \u1076 \u1086 \u1087 . \u1091 \u1089 \u1083 \u1091 \u1075 \u1080  / \u1087 \u1086 \u1074 \u1090 \u1086 \u1088 \u1099 .</div>\
              </div>\
\
              <div class="toggleLine">\
                <label class="checkbox">\
                  <input id="repeatEnabled" type="checkbox" />\
                  <span>\uc0\u1059 \u1095 \u1080 \u1090 \u1099 \u1074 \u1072 \u1090 \u1100  \u1087 \u1086 \u1074 \u1090 \u1086 \u1088 \u1099  / \u1076 \u1086 \u1087 . \u1091 \u1089 \u1083 \u1091 \u1075 \u1080 </span>\
                </label>\
              </div>\
\
              <div id="repeatBlock">\
                <div class="fieldGrid">\
                  <div class="label">\
                    <div class="name">\uc0\u1044 \u1086 \u1083 \u1103  \u1087 \u1072 \u1094 \u1080 \u1077 \u1085 \u1090 \u1086 \u1074  \u1089  \u1076 \u1086 \u1087 . \u1091 \u1089 \u1083 \u1091 \u1075 \u1072 \u1084 \u1080 </div>\
                    <div class="desc">\uc0\u1048 \u1079  \u1086 \u1087 \u1083 \u1072 \u1090 \u1080 \u1074 \u1096 \u1080 \u1093  \'97 \u1082 \u1090 \u1086  \u1087 \u1086 \u1082 \u1091 \u1087 \u1072 \u1077 \u1090  \u1077 \u1097 \u1105 .</div>\
                  </div>\
                  <div class="inputWrap withSuffix">\
                    <input id="repeatShare" type="number" min="0" max="100" step="0.1" />\
                    <span class="suffix">%</span>\
                  </div>\
                </div>\
\
                <div class="fieldGrid">\
                  <div class="label">\
                    <div class="name">\uc0\u1057 \u1088 \u1077 \u1076 \u1085 \u1080 \u1081  \u1076 \u1086 \u1087 . \u1095 \u1077 \u1082 </div>\
                    <div class="desc">\uc0\u1057 \u1082 \u1086 \u1083 \u1100 \u1082 \u1086  \u1074  \u1089 \u1088 \u1077 \u1076 \u1085 \u1077 \u1084  \u1087 \u1088 \u1080 \u1085 \u1086 \u1089 \u1080 \u1090  \u1076 \u1086 \u1087 . \u1087 \u1088 \u1086 \u1076 \u1072 \u1078 \u1072 .</div>\
                  </div>\
                  <div class="inputWrap withSuffix long">\
                    <input id="repeatCheck" type="number" min="0" step="500" />\
                    <span class="suffix">
\f4 \uc0\u8381 
\f0 </span>\
                  </div>\
                </div>\
              </div>\
\
              <div class="note">\uc0\u1055 \u1086 \u1076 \u1089 \u1082 \u1072 \u1079 \u1082 \u1072 : \u1074 \u1082 \u1083 \u1102 \u1095 \u1072 \u1081  \u1087 \u1086 \u1074 \u1090 \u1086 \u1088 \u1099 , \u1077 \u1089 \u1083 \u1080  \u1091  \u1074 \u1072 \u1089  \u1085 \u1086 \u1088 \u1084 \u1072 \u1083 \u1100 \u1085 \u1099 \u1081  \u1082 \u1086 \u1085 \u1090 \u1088 \u1086 \u1083 \u1100  \u1087 \u1083 \u1072 \u1085 \u1072  \u1083 \u1077 \u1095 \u1077 \u1085 \u1080 \u1103  \u1080  \u1072 \u1076 \u1077 \u1082 \u1074 \u1072 \u1090 \u1085 \u1099 \u1081  \u1088 \u1077 \u1090 \u1077 \u1085 \u1096 \u1085 .</div>\
            </div>\
          </div>\
        </div>\
      </section>\
\
      <div style="display:flex;flex-direction:column;gap:18px;">\
        <section class="section" aria-label="\uc0\u1056 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090 \u1099 ">\
          <div class="sectionHeader">\
            <div>\
              <h2>\uc0\u1056 \u1077 \u1079 \u1091 \u1083 \u1100 \u1090 \u1072 \u1090 \u1099 </h2>\
              <div class="hint">\uc0\u1042 \u1089 \u1077  \u1089 \u1091 \u1084 \u1084 \u1099  \'97 
\f4 \uc0\u8381 
\f0  \uc0\u1076 \u1086  \u1094 \u1077 \u1083 \u1099 \u1093 , \u1087 \u1088 \u1086 \u1094 \u1077 \u1085 \u1090 \u1099  \'97 \u1076 \u1086  0.1, \u1082 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1072  \'97 \u1076 \u1086  \u1094 \u1077 \u1083 \u1099 \u1093 .</div>\
            </div>\
            <div class="hint" id="scenarioLabel" style="font-family:var(--mono);">\uc0\u1057 \u1094 \u1077 \u1085 \u1072 \u1088 \u1080 \u1081 : \u1055 \u1045 \u1057 \u1057 \u1048 \u1052 \u1048 \u1057 \u1058 \u1048 \u1063 \u1053 \u1067 \u1049 </div>\
          </div>\
          <div class="content">\
            <div class="resultsGrid" id="kpiGrid"></div>\
          </div>\
        </section>\
\
        <section class="section" aria-label="\uc0\u1042 \u1086 \u1088 \u1086 \u1085 \u1082 \u1072 ">\
          <div class="sectionHeader">\
            <div>\
              <h2>\uc0\u1042 \u1086 \u1088 \u1086 \u1085 \u1082 \u1072 </h2>\
              <div class="hint">\uc0\u1055 \u1086 \u1076 \u1089 \u1074 \u1077 \u1090 \u1082 \u1072  \u1087 \u1086 \u1082 \u1072 \u1079 \u1099 \u1074 \u1072 \u1077 \u1090  \u1089 \u1072 \u1084 \u1086 \u1077  \u1091 \u1079 \u1082 \u1086 \u1077  \u1075 \u1086 \u1088 \u1083 \u1099 \u1096 \u1082 \u1086  (\u1084 \u1072 \u1082 \u1089 \u1080 \u1084 \u1072 \u1083 \u1100 \u1085 \u1099 \u1077  \u1087 \u1086 \u1090 \u1077 \u1088 \u1080  \u1084 \u1077 \u1078 \u1076 \u1091  \u1101 \u1090 \u1072 \u1087 \u1072 \u1084 \u1080 ).</div>\
            </div>\
            <div class="hint" id="bottleneckLabel" style="font-family:var(--mono);">\uc0\u1059 \u1079 \u1082 \u1086 \u1077  \u1084 \u1077 \u1089 \u1090 \u1086 : \'97</div>\
          </div>\
          <div class="content">\
            <div class="funnel" id="funnel"></div>\
          </div>\
        </section>\
\
        <section class="section" aria-label="\uc0\u1063 \u1090 \u1086  \u1087 \u1086 \u1076 \u1082 \u1088 \u1091 \u1090 \u1080 \u1090 \u1100 ">\
          <div class="sectionHeader">\
            <div>\
              <h2>\uc0\u1063 \u1090 \u1086  \u1087 \u1086 \u1076 \u1082 \u1088 \u1091 \u1090 \u1080 \u1090 \u1100 </h2>\
              <div class="hint">\uc0\u1040 \u1074 \u1090 \u1086 -\u1087 \u1086 \u1076 \u1089 \u1082 \u1072 \u1079 \u1082 \u1080  \u1087 \u1086  \u1090 \u1077 \u1082 \u1091 \u1097 \u1080 \u1084  \u1094 \u1080 \u1092 \u1088 \u1072 \u1084 . \u1050 \u1086 \u1088 \u1086 \u1090 \u1082 \u1086  \u1080  \u1087 \u1086  \u1076 \u1077 \u1083 \u1091 .</div>\
            </div>\
          </div>\
          <div class="content">\
            <div class="reco" id="reco"></div>\
          </div>\
        </section>\
      </div>\
    </div>\
  </div>\
\
  <div class="toast" id="toast">
\f5 \uc0\u9989 
\f0  \uc0\u1043 \u1086 \u1090 \u1086 \u1074 \u1086 </div>\
\
  <script>\
    (function()\{\
      const $ = (id)=>document.getElementById(id);\
\
      const DEFAULTS = \{\
        budget: 300000,\
        cpc: 60,\
        clicksManual: 5000,\
        crSite: 2.5,\
        shareTarget: 70,\
        callRate: 65,\
        bookRate: 55,\
        showRate: 70,\
        planRate: 60,\
        payRate: 50,\
        avgCheck: 120000,\
        margin: 45,\
        repeatEnabled: true,\
        repeatShare: 20,\
        repeatCheck: 25000\
      \};\
\
      const IDEAL_DEFAULTS = \{\
        budget: 300000,\
        cpc: 55,\
        clicksManual: 5500,\
        crSite: 3.2,\
        shareTarget: 80,\
        callRate: 80,\
        bookRate: 65,\
        showRate: 78,\
        planRate: 70,\
        payRate: 60,\
        avgCheck: 120000,\
        margin: 48,\
        repeatEnabled: true,\
        repeatShare: 25,\
        repeatCheck: 30000\
      \};\
\
      const PRESETS = \{\
        implant: \{\
          budget: 450000,\
          cpc: 85,\
          clicksManual: 5200,\
          crSite: 2.0,\
          shareTarget: 75,\
          callRate: 70,\
          bookRate: 55,\
          showRate: 72,\
          planRate: 65,\
          payRate: 55,\
          avgCheck: 190000,\
          margin: 47,\
          repeatEnabled: true,\
          repeatShare: 22,\
          repeatCheck: 35000\
        \},\
        therapy: \{\
          budget: 250000,\
          cpc: 45,\
          clicksManual: 6500,\
          crSite: 3.4,\
          shareTarget: 70,\
          callRate: 68,\
          bookRate: 58,\
          showRate: 73,\
          planRate: 55,\
          payRate: 55,\
          avgCheck: 65000,\
          margin: 42,\
          repeatEnabled: true,\
          repeatShare: 28,\
          repeatCheck: 18000\
        \}\
      \};\
\
      const state = \{\
        activeScenario: "p",\
        clickMode: "cpc",\
        scenarios: \{\
          p: structuredClone(DEFAULTS),\
          i: structuredClone(IDEAL_DEFAULTS)\
        \}\
      \};\
\
      const clamp = (v, min, max) => Math.min(max, Math.max(min, v));\
      const num = (x) => Number.isFinite(+x) ? +x : 0;\
\
      function roundQty(x)\{ return Math.round(num(x)); \}\
      function roundMoney(x)\{ return Math.round(num(x)); \}\
      function roundPct(x)\{ return Math.round(num(x)*10)/10; \}\
\
      function fmtInt(x)\{\
        const n = roundQty(x);\
        return n.toLocaleString("ru-RU");\
      \}\
      function fmtMoney(x)\{\
        const n = roundMoney(x);\
        return n.toLocaleString("ru-RU");\
      \}\
      function fmtPct(x)\{\
        if (!Number.isFinite(x)) return "\'97";\
        return (roundPct(x)).toLocaleString("ru-RU") + "%";\
      \}\
      function safeDiv(a,b)\{\
        a = num(a); b = num(b);\
        if (b <= 0) return null;\
        return a / b;\
      \}\
\
      function showToast(text)\{\
        const t = $("toast");\
        t.textContent = text;\
        t.classList.add("show");\
        clearTimeout(showToast._tm);\
        showToast._tm = setTimeout(()=>t.classList.remove("show"), 1600);\
      \}\
\
      function scenarioName(key)\{ return key === "p" ? "\uc0\u1055 \u1045 \u1057 \u1057 \u1048 \u1052 \u1048 \u1057 \u1058 \u1048 \u1063 \u1053 \u1067 \u1049 " : "\u1048 \u1044 \u1045 \u1040 \u1051 \u1068 \u1053 \u1067 \u1049 "; \}\
\
      const KEYS = [\
        "budget","cpc","clicksManual","crSite","shareTarget",\
        "callRate","bookRate","showRate","planRate","payRate",\
        "avgCheck","margin","repeatEnabled","repeatShare","repeatCheck"\
      ];\
\
      function parseBool(v)\{\
        if (v === "1" || v === "true") return true;\
        if (v === "0" || v === "false") return false;\
        return null;\
      \}\
\
      function loadFromURL()\{\
        const sp = new URLSearchParams(location.search);\
\
        const sc = sp.get("sc");\
        if (sc === "p" || sc === "i") state.activeScenario = sc;\
\
        const mode = sp.get("mode");\
        if (mode === "cpc" || mode === "clicks") state.clickMode = mode;\
\
        ["p","i"].forEach(s=>\{\
          KEYS.forEach(k=>\{\
            const v = sp.get(s + "_" + k);\
            if (v === null) return;\
            if (k === "repeatEnabled")\{\
              const b = parseBool(v);\
              if (b !== null) state.scenarios[s][k] = b;\
              return;\
            \}\
            const nv = num(v);\
            if (Number.isFinite(nv)) state.scenarios[s][k] = nv;\
          \});\
        \});\
\
        sanitizeAll();\
      \}\
\
      function buildURL()\{\
        const sp = new URLSearchParams();\
        sp.set("sc", state.activeScenario);\
        sp.set("mode", state.clickMode);\
\
        ["p","i"].forEach(s=>\{\
          const obj = state.scenarios[s];\
          KEYS.forEach(k=>\{\
            const v = obj[k];\
            if (k === "repeatEnabled")\{\
              sp.set(s + "_" + k, v ? "1" : "0");\
            \} else \{\
              sp.set(s + "_" + k, String(num(v)));\
            \}\
          \});\
        \});\
\
        const url = new URL(location.href);\
        url.search = sp.toString();\
        return url.toString();\
      \}\
\
      function sanitizeScenario(s)\{\
        const o = state.scenarios[s];\
\
        o.budget = Math.max(0, num(o.budget));\
        o.cpc = Math.max(0, num(o.cpc));\
        o.clicksManual = Math.max(0, num(o.clicksManual));\
\
        o.crSite = clamp(num(o.crSite), 0, 100);\
        o.shareTarget = clamp(num(o.shareTarget), 0, 100);\
        o.callRate = clamp(num(o.callRate), 0, 100);\
        o.bookRate = clamp(num(o.bookRate), 0, 100);\
        o.showRate = clamp(num(o.showRate), 0, 100);\
        o.planRate = clamp(num(o.planRate), 0, 100);\
        o.payRate = clamp(num(o.payRate), 0, 100);\
        o.margin = clamp(num(o.margin), 0, 100);\
\
        o.avgCheck = Math.max(0, num(o.avgCheck));\
        o.repeatShare = clamp(num(o.repeatShare), 0, 100);\
        o.repeatCheck = Math.max(0, num(o.repeatCheck));\
\
        o.repeatEnabled = !!o.repeatEnabled;\
      \}\
\
      function sanitizeAll()\{\
        sanitizeScenario("p");\
        sanitizeScenario("i");\
      \}\
\
      function calc(s)\{\
        const o = state.scenarios[s];\
\
        const budget = num(o.budget);\
        const clicks = state.clickMode === "cpc"\
          ? (o.cpc > 0 ? budget / num(o.cpc) : 0)\
          : num(o.clicksManual);\
\
        const leads = clicks * (num(o.crSite)/100);\
        const target = leads * (num(o.shareTarget)/100);\
        const calls = target * (num(o.callRate)/100);\
        const books = calls * (num(o.bookRate)/100);\
        const shows = books * (num(o.showRate)/100);\
        const plans = shows * (num(o.planRate)/100);\
        const pays  = plans * (num(o.payRate)/100);\
\
        const revMain = pays * num(o.avgCheck);\
        const revRepeat = o.repeatEnabled\
          ? (pays * (num(o.repeatShare)/100)) * num(o.repeatCheck)\
          : 0;\
\
        const revenue = revMain + revRepeat;\
        const profit = revenue * (num(o.margin)/100);\
\
        const romi = budget > 0 ? ((profit - budget) / budget) * 100 : null;\
        const cpl  = safeDiv(budget, leads);\
        const cpaBook = safeDiv(budget, books);\
        const cac  = safeDiv(budget, pays);\
\
        return \{\
          budget,\
          clicks,\
          leads,\
          target,\
          calls,\
          books,\
          shows,\
          plans,\
          pays,\
          revMain,\
          revRepeat,\
          revenue,\
          profit,\
          romi,\
          cpl,\
          cpaBook,\
          cac\
        \};\
      \}\
\
      function stageList(r)\{\
        return [\
          \{ key:"clicks", label:"\uc0\u1050 \u1083 \u1080 \u1082 \u1080 ", value:r.clicks \},\
          \{ key:"leads", label:"\uc0\u1047 \u1072 \u1103 \u1074 \u1082 \u1080 ", value:r.leads \},\
          \{ key:"target", label:"\uc0\u1062 \u1077 \u1083 \u1077 \u1074 \u1099 \u1077  \u1079 \u1072 \u1103 \u1074 \u1082 \u1080 ", value:r.target \},\
          \{ key:"calls", label:"\uc0\u1044 \u1086 \u1079 \u1074 \u1086 \u1085 \u1099 ", value:r.calls \},\
          \{ key:"books", label:"\uc0\u1047 \u1072 \u1087 \u1080 \u1089 \u1080 ", value:r.books \},\
          \{ key:"shows", label:"\uc0\u1055 \u1088 \u1080 \u1096 \u1083 \u1080 ", value:r.shows \},\
          \{ key:"plans", label:"\uc0\u1055 \u1083 \u1072 \u1085 \u1099  \u1083 \u1077 \u1095 \u1077 \u1085 \u1080 \u1103 ", value:r.plans \},\
          \{ key:"pays", label:"\uc0\u1054 \u1087 \u1083 \u1072 \u1090 \u1099  (\u1087 \u1072 \u1094 \u1080 \u1077 \u1085 \u1090 \u1099 )", value:r.pays \}\
        ];\
      \}\
\
      const inputMap = [\
        ["budget","budget"],\
        ["cpc","cpc"],\
        ["clicksManual","clicksManual"],\
        ["crSite","crSite"],\
        ["shareTarget","shareTarget"],\
        ["callRate","callRate"],\
        ["bookRate","bookRate"],\
        ["showRate","showRate"],\
        ["planRate","planRate"],\
        ["payRate","payRate"],\
        ["avgCheck","avgCheck"],\
        ["margin","margin"],\
        ["repeatShare","repeatShare"],\
        ["repeatCheck","repeatCheck"]\
      ];\
\
      function fillInputsFromScenario()\{\
        const s = state.activeScenario;\
        const o = state.scenarios[s];\
\
        inputMap.forEach(([id,key])=>\{\
          $(id).value = String(num(o[key]));\
        \});\
\
        $("repeatEnabled").checked = !!o.repeatEnabled;\
        $("repeatBlock").style.display = o.repeatEnabled ? "" : "none";\
\
        $("scenarioLabel").textContent = "\uc0\u1057 \u1094 \u1077 \u1085 \u1072 \u1088 \u1080 \u1081 : " + scenarioName(s);\
\
        $("modeCPC").setAttribute("aria-pressed", state.clickMode === "cpc" ? "true" : "false");\
        $("modeClicks").setAttribute("aria-pressed", state.clickMode === "clicks" ? "true" : "false");\
        $("rowCPC").style.display = state.clickMode === "cpc" ? "" : "none";\
        $("rowClicks").style.display = state.clickMode === "clicks" ? "" : "none";\
\
        $("btnScenarioP").setAttribute("aria-pressed", s === "p" ? "true" : "false");\
        $("btnScenarioI").setAttribute("aria-pressed", s === "i" ? "true" : "false");\
      \}\
\
      function onAnyInput()\{\
        const s = state.activeScenario;\
        const o = state.scenarios[s];\
\
        inputMap.forEach(([id,key])=>\{\
          o[key] = num($(id).value);\
        \});\
\
        o.repeatEnabled = $("repeatEnabled").checked;\
\
        sanitizeScenario(s);\
        $("repeatBlock").style.display = o.repeatEnabled ? "" : "none";\
\
        render();\
        history.replaceState(null, "", buildURL());\
      \}\
\
      function setScenario(s)\{\
        state.activeScenario = s;\
        fillInputsFromScenario();\
        render();\
        history.replaceState(null, "", buildURL());\
      \}\
\
      function setMode(m)\{\
        state.clickMode = m;\
        fillInputsFromScenario();\
        render();\
        history.replaceState(null, "", buildURL());\
      \}\
\
      function applyPreset(preset)\{\
        const s = state.activeScenario;\
        state.scenarios[s] = Object.assign(state.scenarios[s], structuredClone(preset));\
        sanitizeScenario(s);\
        fillInputsFromScenario();\
        render();\
        history.replaceState(null, "", buildURL());\
        showToast("\uc0\u1055 \u1088 \u1077 \u1089 \u1077 \u1090  \u1087 \u1088 \u1080 \u1084 \u1077 \u1085 \u1105 \u1085  \u1082  \u1089 \u1094 \u1077 \u1085 \u1072 \u1088 \u1080 \u1102 : " + scenarioName(s));\
      \}\
\
      function renderKPIs(r)\{\
        const grid = $("kpiGrid");\
        const money = (v)=> (v == null ? "\'97" : fmtMoney(v) + " 
\f4 \uc0\u8381 
\f0 ");\
        const qty = (v)=> fmtInt(v);\
\
        const cpl = r.cpl == null ? "\'97" : (fmtMoney(r.cpl) + " 
\f4 \uc0\u8381 
\f0 ");\
        const cpaBook = r.cpaBook == null ? "\'97" : (fmtMoney(r.cpaBook) + " 
\f4 \uc0\u8381 
\f0 ");\
        const cac = r.cac == null ? "\'97" : (fmtMoney(r.cac) + " 
\f4 \uc0\u8381 
\f0 ");\
        const romi = r.romi == null ? "\'97" : fmtPct(r.romi);\
\
        const items = [\
          \{ name:"\uc0\u1050 \u1083 \u1080 \u1082 \u1080 ", val: qty(r.clicks), badge: state.clickMode==="cpc" ? ("CPC: " + fmtMoney(state.scenarios[state.activeScenario].cpc) + " 
\f4 \uc0\u8381 
\f0 ") : "\uc0\u1074 \u1074 \u1077 \u1076 \u1077 \u1085 \u1086 ", wide:false \},\
          \{ name:"\uc0\u1047 \u1072 \u1103 \u1074 \u1082 \u1080 ", val: qty(r.leads), badge: "CR \u1089 \u1072 \u1081 \u1090 \u1072 ", sub: fmtPct(state.scenarios[state.activeScenario].crSite), wide:false \},\
          \{ name:"\uc0\u1062 \u1077 \u1083 \u1077 \u1074 \u1099 \u1077 ", val: qty(r.target), badge: "\u1076 \u1086 \u1083 \u1103 ", sub: fmtPct(state.scenarios[state.activeScenario].shareTarget), wide:false \},\
\
          \{ name:"\uc0\u1044 \u1086 \u1079 \u1074 \u1086 \u1085 \u1099 ", val: qty(r.calls), badge: "\u1076 \u1086 \u1079 \u1074 \u1086 \u1085 ", sub: fmtPct(state.scenarios[state.activeScenario].callRate), wide:false \},\
          \{ name:"\uc0\u1047 \u1072 \u1087 \u1080 \u1089 \u1080 ", val: qty(r.books), badge: "\u1079 \u1072 \u1087 \u1080 \u1089 \u1100 ", sub: fmtPct(state.scenarios[state.activeScenario].bookRate), wide:false \},\
          \{ name:"\uc0\u1055 \u1088 \u1080 \u1096 \u1083 \u1080 ", val: qty(r.shows), badge: "\u1076 \u1086 \u1096 \u1083 \u1080 ", sub: fmtPct(state.scenarios[state.activeScenario].showRate), wide:false \},\
\
          \{ name:"\uc0\u1055 \u1083 \u1072 \u1085 \u1099  \u1083 \u1077 \u1095 \u1077 \u1085 \u1080 \u1103 ", val: qty(r.plans), badge: "\u1074  \u1087 \u1083 \u1072 \u1085 ", sub: fmtPct(state.scenarios[state.activeScenario].planRate), wide:false \},\
          \{ name:"\uc0\u1054 \u1087 \u1083 \u1072 \u1090 \u1099  (\u1087 \u1072 \u1094 \u1080 \u1077 \u1085 \u1090 \u1099 )", val: qty(r.pays), badge: "\u1074  \u1086 \u1087 \u1083 \u1072 \u1090 \u1091 ", sub: fmtPct(state.scenarios[state.activeScenario].payRate), wide:false \},\
\
          \{ name:"\uc0\u1042 \u1099 \u1088 \u1091 \u1095 \u1082 \u1072 ", val: money(r.revenue), badge: "\u1074 \u1089 \u1077 \u1075 \u1086 ", sub: (state.scenarios[state.activeScenario].repeatEnabled ? ("\u1087 \u1086 \u1074 \u1090 \u1086 \u1088 \u1099 : " + fmtMoney(r.revRepeat) + " 
\f4 \uc0\u8381 
\f0 ") : "\uc0\u1087 \u1086 \u1074 \u1090 \u1086 \u1088 \u1099 : \u1074 \u1099 \u1082 \u1083 "), wide:true, strong:true \},\
          \{ name:"\uc0\u1042 \u1072 \u1083 \u1086 \u1074 \u1072 \u1103  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100 ", val: money(r.profit), badge: "\u1084 \u1072 \u1088 \u1078 \u1072 ", sub: fmtPct(state.scenarios[state.activeScenario].margin), wide:true, strong:true \},\
\
          \{ name:"ROMI", val: romi, badge: "\uc0\u1087 \u1086  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1080 ", sub: ("\u1073 \u1102 \u1076 \u1078 \u1077 \u1090 : " + fmtMoney(r.budget) + " 
\f4 \uc0\u8381 
\f0 "), wide:false, strong:true \},\
          \{ name:"CPL", val: cpl, badge: "\uc0\u1094 \u1077 \u1085 \u1072  \u1079 \u1072 \u1103 \u1074 \u1082 \u1080 ", sub: "", wide:false \},\
          \{ name:"\uc0\u1062 \u1077 \u1085 \u1072  \u1079 \u1072 \u1087 \u1080 \u1089 \u1080 ", val: cpaBook, badge: "\u1094 \u1077 \u1085 \u1072  \u1079 \u1072 \u1087 \u1080 \u1089 \u1080 ", sub: "", wide:false \},\
          \{ name:"CAC", val: cac, badge: "\uc0\u1094 \u1077 \u1085 \u1072  \u1087 \u1072 \u1094 \u1080 \u1077 \u1085 \u1090 \u1072 ", sub: "", wide:false \}\
        ];\
\
        grid.innerHTML = items.map(it=>\{\
          const cls = ["kpi", it.wide ? "wide" : ""].join(" ").trim();\
          const vcls = ["v", it.strong ? "strong" : "money"].join(" ");\
          return `\
            <div class="$\{cls\}">\
              <div class="k">\
                <div class="name">$\{it.name\}</div>\
                <div class="badge">$\{it.badge || ""\}</div>\
              </div>\
              <div class="$\{vcls\}">$\{it.val\}</div>\
              <div class="sub">\
                <span>$\{it.sub || ""\}</span>\
                <span></span>\
              </div>\
            </div>\
          `;\
        \}).join("");\
      \}\
\
      function renderFunnel(r)\{\
        const list = stageList(r);\
        const max = Math.max(1, ...list.map(x=>num(x.value)));\
\
        let bottleneckIdx = -1;\
        let worstConv = Infinity;\
\
        const convs = [];\
        for (let i=1;i<list.length;i++)\{\
          const prev = num(list[i-1].value);\
          const cur = num(list[i].value);\
          const conv = prev > 0 ? (cur/prev)*100 : null;\
          convs.push(conv);\
          if (conv !== null && conv < worstConv)\{\
            worstConv = conv;\
            bottleneckIdx = i;\
          \}\
        \}\
\
        if (bottleneckIdx >= 1 && Number.isFinite(worstConv))\{\
          $("bottleneckLabel").textContent = "\uc0\u1059 \u1079 \u1082 \u1086 \u1077  \u1084 \u1077 \u1089 \u1090 \u1086 : " + list[bottleneckIdx].label + " (" + fmtPct(worstConv) + " \u1086 \u1090  \u1087 \u1088 \u1077 \u1076 \u1099 \u1076 \u1091 \u1097 \u1077 \u1075 \u1086  \u1101 \u1090 \u1072 \u1087 \u1072 )";\
        \} else \{\
          $("bottleneckLabel").textContent = "\uc0\u1059 \u1079 \u1082 \u1086 \u1077  \u1084 \u1077 \u1089 \u1090 \u1086 : \'97";\
        \}\
\
        const funnel = $("funnel");\
        funnel.innerHTML = list.map((st, i)=>\{\
          const pct = (i===0) ? null : convs[i-1];\
          const loss = (i===0 || pct===null) ? null : (100 - pct);\
          const w = clamp((num(st.value)/max)*100, 0, 100);\
          const isBottle = (i === bottleneckIdx && i > 0 && pct !== null);\
\
          return `\
            <div class="fRow $\{isBottle ? "bottleneck" : ""\}">\
              <div class="fLeft">\
                <div class="stage"><span class="dot"></span>$\{st.label\}</div>\
                <div class="meta">\
                  <span>\uc0\u1082 \u1086 \u1083 -\u1074 \u1086 : <b style="color:rgba(255,255,255,.86)">$\{fmtInt(st.value)\}</b></span>\
                  $\{i===0 ? `<span>\uc0\u1089 \u1090 \u1072 \u1088 \u1090 </span>` : `<span>\u1082 \u1086 \u1085 \u1074 .: <b style="color:$\{isBottle ? "rgba(255,77,109,.92)" : "rgba(255,255,255,.82)"\}">$\{fmtPct(pct)\}</b></span>`\}\
                  $\{loss===null ? "" : `<span>\uc0\u1087 \u1086 \u1090 \u1077 \u1088 \u1080 : <b style="color:$\{isBottle ? "rgba(255,77,109,.92)" : "rgba(255,255,255,.70)"\}">$\{fmtPct(loss)\}</b></span>`\}\
                </div>\
              </div>\
              <div class="barWrap">\
                <div class="bar"><div class="fill" style="width:$\{w.toFixed(2)\}%"></div></div>\
                <div class="barHint">\
                  <span>$\{i===0 ? "100% \uc0\u1086 \u1090  \u1089 \u1090 \u1072 \u1088 \u1090 \u1072 " : (pct===null ? "\'97" : (fmtPct(pct) + " \u1086 \u1090  \u1087 \u1088 \u1077 \u1076 \u1099 \u1076 \u1091 \u1097 \u1077 \u1075 \u1086 "))\}</span>\
                  <span style="color:$\{isBottle ? "rgba(255,77,109,.85)" : "rgba(255,255,255,.45)"\}">$\{isBottle ? "\uc0\u1091 \u1079 \u1082 \u1086 \u1077  \u1084 \u1077 \u1089 \u1090 \u1086 " : ""\}</span>\
                </div>\
              </div>\
            </div>\
          `;\
        \}).join("");\
      \}\
\
      function renderReco(r)\{\
        const o = state.scenarios[state.activeScenario];\
        const rec = [];\
        const t = \{ crSiteLow: 1.8, targetLow: 60, callLow: 60, bookLow: 50, showLow: 65, planLow: 55, payLow: 45 \};\
\
        if (o.crSite < t.crSiteLow)\{\
          rec.push(\{ type:"bad", icon:"
\f5 \uc0\u55358 \u56809 
\f0 ", title:"\uc0\u1057 \u1072 \u1081 \u1090 /\u1086 \u1092 \u1092 \u1077 \u1088  \u1089 \u1083 \u1072 \u1073 \u1086 \u1074 \u1072 \u1090 \u1099 : \u1079 \u1072 \u1103 \u1074 \u1082 \u1080  \u1090 \u1077 \u1088 \u1103 \u1102 \u1090 \u1089 \u1103  \u1085 \u1072  \u1074 \u1093 \u1086 \u1076 \u1077 .",\
            desc:"\uc0\u1055 \u1088 \u1086 \u1074 \u1077 \u1088 \u1100  \u1089 \u1082 \u1086 \u1088 \u1086 \u1089 \u1090 \u1100 , \u1087 \u1077 \u1088 \u1074 \u1099 \u1081  \u1101 \u1082 \u1088 \u1072 \u1085 , \u1092 \u1086 \u1088 \u1084 \u1091 , \u1094 \u1077 \u1085 \u1099 /\u1075 \u1072 \u1088 \u1072 \u1085 \u1090 \u1080 \u1080 , \u1080  \u1089 \u1086 \u1086 \u1090 \u1074 \u1077 \u1090 \u1089 \u1090 \u1074 \u1080 \u1077  \u1086 \u1073 \u1098 \u1103 \u1074 \u1083 \u1077 \u1085 \u1080 \u1081  \u1087 \u1086 \u1089 \u1072 \u1076 \u1086 \u1095 \u1085 \u1086 \u1081 ."\});\
        \} else \{\
          rec.push(\{ type:"good", icon:"
\f5 \uc0\u55356 \u57151 
\f0 ", title:"\uc0\u1057 \u1072 \u1081 \u1090  \u1076 \u1072 \u1105 \u1090  \u1079 \u1072 \u1103 \u1074 \u1082 \u1080  \u1085 \u1086 \u1088 \u1084 \u1072 \u1083 \u1100 \u1085 \u1086 .",\
            desc:"\uc0\u1044 \u1072 \u1083 \u1100 \u1096 \u1077  \u1074 \u1099 \u1080 \u1075 \u1088 \u1099 \u1096  \u1073 \u1091 \u1076 \u1077 \u1090  \u1074  \u1082 \u1086 \u1083 \u1083 -\u1094 \u1077 \u1085 \u1090 \u1088 \u1077  \u1080  \u1085 \u1072  \u1082 \u1086 \u1085 \u1089 \u1091 \u1083 \u1100 \u1090 \u1072 \u1094 \u1080 \u1080 ."\});\
        \}\
\
        if (o.shareTarget < t.targetLow)\{\
          rec.push(\{ type:"bad", icon:"
\f5 \uc0\u55356 \u57263 
\f0 ", title:"\uc0\u1052 \u1085 \u1086 \u1075 \u1086  \u1085 \u1077 \u1094 \u1077 \u1083 \u1077 \u1074 \u1099 \u1093  \u1079 \u1072 \u1103 \u1074 \u1086 \u1082  \'97 \u1073 \u1102 \u1076 \u1078 \u1077 \u1090  \u1089 \u1075 \u1086 \u1088 \u1072 \u1077 \u1090  \u1074  \u1096 \u1091 \u1084 .",\
            desc:"\uc0\u1059 \u1078 \u1084 \u1080  \u1089 \u1077 \u1084 \u1072 \u1085 \u1090 \u1080 \u1082 \u1091 , \u1084 \u1080 \u1085 \u1091 \u1089 -\u1089 \u1083 \u1086 \u1074 \u1072 , \u1075 \u1077 \u1086 , \u1091 \u1090 \u1086 \u1095 \u1085 \u1080  \u1086 \u1092 \u1092 \u1077 \u1088 ; \u1088 \u1072 \u1079 \u1076 \u1077 \u1083 \u1080  \u1082 \u1072 \u1084 \u1087 \u1072 \u1085 \u1080 \u1080  \u1087 \u1086  \u1091 \u1089 \u1083 \u1091 \u1075 \u1072 \u1084 ."\});\
        \}\
\
        if (o.callRate < t.callLow)\{\
          rec.push(\{ type:"bad", icon:"
\f5 \uc0\u55357 \u56542 
\f0 ", title:"\uc0\u1059  \u1090 \u1077 \u1073 \u1103  \u1076 \u1099 \u1088 \u1103 \u1074 \u1099 \u1081  \u1082 \u1086 \u1083 \u1083 -\u1094 \u1077 \u1085 \u1090 \u1088 : \u1076 \u1086 \u1079 \u1074 \u1086 \u1085  \u1085 \u1080 \u1079 \u1082 \u1080 \u1081 .",\
            desc:"\uc0\u1057 \u1083 \u1091 \u1096 \u1072 \u1081  \u1079 \u1074 \u1086 \u1085 \u1082 \u1080 , \u1089 \u1090 \u1072 \u1074 \u1100  \u1082 \u1086 \u1085 \u1090 \u1088 \u1086 \u1083 \u1100  \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1080  \u1088 \u1077 \u1072 \u1082 \u1094 \u1080 \u1080 , \u1084 \u1077 \u1085 \u1103 \u1081  \u1089 \u1082 \u1088 \u1080 \u1087 \u1090 , \u1076 \u1086 \u1073 \u1080 \u1074 \u1072 \u1081  \u1079 \u1072 \u1103 \u1074 \u1086 \u1082  \u1087 \u1086 \u1074 \u1090 \u1086 \u1088 \u1085 \u1099 \u1084 \u1080  \u1082 \u1072 \u1089 \u1072 \u1085 \u1080 \u1103 \u1084 \u1080 ."\});\
        \}\
\
        if (o.callRate >= t.callLow && o.bookRate < t.bookLow)\{\
          rec.push(\{ type:"bad", icon:"
\f5 \uc0\u55357 \u56787 \u65039 
\f0 ", title:"\uc0\u1044 \u1086 \u1079 \u1074 \u1072 \u1085 \u1080 \u1074 \u1072 \u1077 \u1090 \u1077 \u1089 \u1100 , \u1085 \u1086  \u1087 \u1083 \u1086 \u1093 \u1086  \u1079 \u1072 \u1087 \u1080 \u1089 \u1099 \u1074 \u1072 \u1077 \u1090 \u1077 .",\
            desc:"\uc0\u1057 \u1082 \u1088 \u1080 \u1087 \u1090  \u1085 \u1072  \u1094 \u1077 \u1085 \u1085 \u1086 \u1089 \u1090 \u1080 /\u1087 \u1086 \u1074 \u1086 \u1076  \u1087 \u1088 \u1080 \u1081 \u1090 \u1080 , \u1074 \u1072 \u1088 \u1080 \u1072 \u1085 \u1090 \u1099  \u1074 \u1088 \u1077 \u1084 \u1077 \u1085 \u1080 , \u1092 \u1080 \u1082 \u1089 \u1080 \u1088 \u1091 \u1081  \u1089 \u1083 \u1077 \u1076 \u1091 \u1102 \u1097 \u1080 \u1081  \u1096 \u1072 \u1075 , \u1091 \u1073 \u1077 \u1088 \u1080  \'ab\u1087 \u1086 \u1076 \u1091 \u1084 \u1072 \u1102 \'bb."\});\
        \}\
\
        if (o.bookRate >= t.bookLow && o.showRate < t.showLow)\{\
          rec.push(\{ type:"bad", icon:"
\f5 \uc0\u9989 
\f0 ", title:"\uc0\u1047 \u1072 \u1087 \u1080 \u1089 \u1100  \u1077 \u1089 \u1090 \u1100 , \u1085 \u1086  \u1083 \u1102 \u1076 \u1080  \u1085 \u1077  \u1076 \u1086 \u1093 \u1086 \u1076 \u1103 \u1090 .",\
            desc:"\uc0\u1055 \u1086 \u1076 \u1090 \u1074 \u1077 \u1088 \u1078 \u1076 \u1077 \u1085 \u1080 \u1103 , \u1085 \u1072 \u1087 \u1086 \u1084 \u1080 \u1085 \u1072 \u1085 \u1080 \u1103 , WhatsApp, \u1084 \u1072 \u1088 \u1096 \u1088 \u1091 \u1090 /\u1087 \u1072 \u1088 \u1082 \u1086 \u1074 \u1082 \u1072 , \u1076 \u1077 \u1087 \u1086 \u1079 \u1080 \u1090 /\u1087 \u1088 \u1077 \u1076 \u1086 \u1087 \u1083 \u1072 \u1090 \u1072 , \u1087 \u1077 \u1088 \u1077 \u1085 \u1086 \u1089  \u1073 \u1077 \u1079  \u1089 \u1090 \u1099 \u1076 \u1072 ."\});\
        \}\
\
        if (o.showRate >= t.showLow && (o.planRate < t.planLow || o.payRate < t.payLow))\{\
          rec.push(\{ type:"bad", icon:"
\f5 \uc0\u55358 \u56759 
\f0 ", title:"\uc0\u1055 \u1088 \u1080 \u1093 \u1086 \u1076 \u1103 \u1090 , \u1085 \u1086  \u1085 \u1077  \u1087 \u1086 \u1082 \u1091 \u1087 \u1072 \u1102 \u1090  \'97 \u1087 \u1088 \u1086 \u1073 \u1083 \u1077 \u1084 \u1072  \u1074  \u1082 \u1086 \u1085 \u1089 \u1091 \u1083 \u1100 \u1090 \u1072 \u1094 \u1080 \u1080 /\u1087 \u1088 \u1077 \u1079 \u1077 \u1085 \u1090 \u1072 \u1094 \u1080 \u1080 .",\
            desc:"\uc0\u1044 \u1080 \u1072 \u1075 \u1085 \u1086 \u1089 \u1090 \u1080 \u1082 \u1072  \u1080  \u1076 \u1086 \u1074 \u1077 \u1088 \u1080 \u1077 , \u1087 \u1086 \u1085 \u1103 \u1090 \u1085 \u1099 \u1081  \u1087 \u1083 \u1072 \u1085 , \u1074 \u1072 \u1088 \u1080 \u1072 \u1085 \u1090 \u1099  \u1087 \u1086  \u1073 \u1102 \u1076 \u1078 \u1077 \u1090 \u1091 , \u1088 \u1072 \u1073 \u1086 \u1090 \u1072  \u1089  \u1074 \u1086 \u1079 \u1088 \u1072 \u1078 \u1077 \u1085 \u1080 \u1103 \u1084 \u1080 , \u1082 \u1077 \u1081 \u1089 \u1099  \u1080  \u1075 \u1072 \u1088 \u1072 \u1085 \u1090 \u1080 \u1080 ."\});\
        \}\
\
        if (r.romi !== null && r.romi < 0)\{\
          rec.push(\{ type:"bad", icon:"
\f5 \uc0\u55357 \u56504 
\f0 ", title:"ROMI \uc0\u1086 \u1090 \u1088 \u1080 \u1094 \u1072 \u1090 \u1077 \u1083 \u1100 \u1085 \u1099 \u1081 : \u1088 \u1077 \u1082 \u1083 \u1072 \u1084 \u1072  \u1086 \u1082 \u1091 \u1087 \u1072 \u1077 \u1090 \u1089 \u1103  \u1087 \u1083 \u1086 \u1093 \u1086 .",\
            desc:"\uc0\u1057 \u1085 \u1072 \u1095 \u1072 \u1083 \u1072  \u1095 \u1080 \u1085 \u1080  \u1075 \u1086 \u1088 \u1083 \u1099 \u1096 \u1082 \u1086  \u1074 \u1086 \u1088 \u1086 \u1085 \u1082 \u1080 , \u1087 \u1086 \u1090 \u1086 \u1084  \u1084 \u1072 \u1089 \u1096 \u1090 \u1072 \u1073 \u1080 \u1088 \u1091 \u1081 . \u1053 \u1077  \u1085 \u1072 \u1086 \u1073 \u1086 \u1088 \u1086 \u1090 ."\});\
        \} else if (r.romi !== null && r.romi >= 50)\{\
          rec.push(\{ type:"good", icon:"
\f5 \uc0\u9889 
\f0 ", title:"ROMI \uc0\u1074 \u1099 \u1075 \u1083 \u1103 \u1076 \u1080 \u1090  \u1073 \u1086 \u1076 \u1088 \u1086  \'97 \u1084 \u1086 \u1078 \u1085 \u1086  \u1072 \u1082 \u1082 \u1091 \u1088 \u1072 \u1090 \u1085 \u1086  \u1084 \u1072 \u1089 \u1096 \u1090 \u1072 \u1073 \u1080 \u1088 \u1086 \u1074 \u1072 \u1090 \u1100 .",\
            desc:"\uc0\u1055 \u1086 \u1076 \u1085 \u1080 \u1084 \u1072 \u1081  \u1073 \u1102 \u1076 \u1078 \u1077 \u1090  \u1087 \u1086 \u1089 \u1090 \u1077 \u1087 \u1077 \u1085 \u1085 \u1086  \u1080  \u1089 \u1083 \u1077 \u1076 \u1080 , \u1095 \u1090 \u1086 \u1073 \u1099  \u1091 \u1079 \u1082 \u1086 \u1077  \u1084 \u1077 \u1089 \u1090 \u1086  \u1085 \u1077  \'ab\u1087 \u1086 \u1077 \u1093 \u1072 \u1083 \u1086 \'bb."\});\
        \}\
\
        $("reco").innerHTML = rec.slice(0, 6).map(x=>`\
          <div class="chip $\{x.type\}">\
            <div class="icon">$\{x.icon\}</div>\
            <div class="txt">\
              <div class="t">$\{x.title\}</div>\
              <div class="d">$\{x.desc\}</div>\
            </div>\
          </div>\
        `).join("");\
      \}\
\
      function render()\{\
        const r = calc(state.activeScenario);\
        renderKPIs(r);\
        renderFunnel(r);\
        renderReco(r);\
      \}\
\
      function buildCSV()\{\
        const r = calc(state.activeScenario);\
        const list = stageList(r);\
        const rows = [];\
        rows.push(["\uc0\u1069 \u1090 \u1072 \u1087 ","\u1050 \u1086 \u1083 \u1080 \u1095 \u1077 \u1089 \u1090 \u1074 \u1086  (\u1096 \u1090 )","\u1050 \u1086 \u1085 \u1074 \u1077 \u1088 \u1089 \u1080 \u1103  \u1086 \u1090  \u1087 \u1088 \u1077 \u1076 \u1099 \u1076 \u1091 \u1097 \u1077 \u1075 \u1086  (%)"].join(";"));\
        for (let i=0;i<list.length;i++)\{\
          const cur = roundQty(list[i].value);\
          let c = "";\
          if (i>0)\{\
            const prev = num(list[i-1].value);\
            const conv = prev>0 ? (num(list[i].value)/prev)*100 : null;\
            c = conv==null ? "" : String(roundPct(conv)).replace(".", ",");\
          \}\
          rows.push([list[i].label, String(cur), c].join(";"));\
        \}\
        rows.push("");\
        rows.push(["\uc0\u1055 \u1086 \u1082 \u1072 \u1079 \u1072 \u1090 \u1077 \u1083 \u1100 ","\u1047 \u1085 \u1072 \u1095 \u1077 \u1085 \u1080 \u1077 "].join(";"));\
        rows.push(["\uc0\u1041 \u1102 \u1076 \u1078 \u1077 \u1090  (
\f4 \uc0\u8381 
\f0 )", String(roundMoney(r.budget))].join(";"));\
        rows.push(["\uc0\u1042 \u1099 \u1088 \u1091 \u1095 \u1082 \u1072  (
\f4 \uc0\u8381 
\f0 )", String(roundMoney(r.revenue))].join(";"));\
        rows.push(["\uc0\u1042 \u1072 \u1083 \u1086 \u1074 \u1072 \u1103  \u1087 \u1088 \u1080 \u1073 \u1099 \u1083 \u1100  (
\f4 \uc0\u8381 
\f0 )", String(roundMoney(r.profit))].join(";"));\
        rows.push(["ROMI (%)", r.romi==null ? "" : String(roundPct(r.romi)).replace(".", ",")].join(";"));\
        return rows.join("\\n");\
      \}\
\
      function downloadCSV()\{\
        const csv = buildCSV();\
        const blob = new Blob([csv], \{type:"text/csv;charset=utf-8"\});\
        const url = URL.createObjectURL(blob);\
        const a = document.createElement("a");\
        a.href = url;\
        a.download = "stom_funnel_" + (state.activeScenario==="p" ? "pessimistic" : "ideal") + ".csv";\
        document.body.appendChild(a);\
        a.click();\
        a.remove();\
        URL.revokeObjectURL(url);\
        showToast("CSV \uc0\u1089 \u1082 \u1072 \u1095 \u1072 \u1085 ");\
      \}\
\
      inputMap.forEach(([id])=>\{\
        $(id).addEventListener("input", render);\
        $(id).addEventListener("input", onAnyInput);\
        $(id).addEventListener("change", onAnyInput);\
      \});\
      $("repeatEnabled").addEventListener("change", onAnyInput);\
\
      $("btnScenarioP").addEventListener("click", ()=>\{ state.activeScenario="p"; fillInputsFromScenario(); render(); history.replaceState(null,"",buildURL()); \});\
      $("btnScenarioI").addEventListener("click", ()=>\{ state.activeScenario="i"; fillInputsFromScenario(); render(); history.replaceState(null,"",buildURL()); \});\
\
      $("modeCPC").addEventListener("click", ()=>\{ state.clickMode="cpc"; fillInputsFromScenario(); render(); history.replaceState(null,"",buildURL()); \});\
      $("modeClicks").addEventListener("click", ()=>\{ state.clickMode="clicks"; fillInputsFromScenario(); render(); history.replaceState(null,"",buildURL()); \});\
\
      $("presetImplant").addEventListener("click", ()=>applyPreset(PRESETS.implant));\
      $("presetTherapy").addEventListener("click", ()=>applyPreset(PRESETS.therapy));\
\
      $("btnCSV").addEventListener("click", downloadCSV);\
\
      $("btnCopyLink").addEventListener("click", async ()=>\{\
        const url = buildURL();\
        try\{\
          await navigator.clipboard.writeText(url);\
          showToast("\uc0\u1057 \u1089 \u1099 \u1083 \u1082 \u1072  \u1089 \u1082 \u1086 \u1087 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1072 ");\
        \}catch(e)\{\
          const ta = document.createElement("textarea");\
          ta.value = url;\
          document.body.appendChild(ta);\
          ta.select();\
          document.execCommand("copy");\
          ta.remove();\
          showToast("\uc0\u1057 \u1089 \u1099 \u1083 \u1082 \u1072  \u1089 \u1082 \u1086 \u1087 \u1080 \u1088 \u1086 \u1074 \u1072 \u1085 \u1072 ");\
        \}\
      \});\
\
      $("btnReset").addEventListener("click", ()=>\{\
        state.clickMode = "cpc";\
        state.scenarios.p = structuredClone(DEFAULTS);\
        state.scenarios.i = structuredClone(IDEAL_DEFAULTS);\
        state.activeScenario = "p";\
        sanitizeAll();\
        fillInputsFromScenario();\
        render();\
        history.replaceState(null, "", buildURL());\
        showToast("\uc0\u1057 \u1073 \u1088 \u1086 \u1096 \u1077 \u1085 \u1086 ");\
      \});\
\
      loadFromURL();\
      fillInputsFromScenario();\
      render();\
      history.replaceState(null, "", buildURL());\
    \})();\
  </script>\
</body>\
</html>\
}